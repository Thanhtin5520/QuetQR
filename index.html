<!DOCTYPE html>
<html>
<head>
  <title>Scan from Phone</title>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>
  <h1>Scan Barcode</h1>
  <div id="reader" style="width:300px;"></div>

  <script>
    const socket = io();
    const session_id = Date.now().toString();

    function onScanSuccess(decodedText) {
      console.log(`Scanned: ${decodedText}`);
      socket.emit("scan", { code: decodedText, session_id });
    }

    const html5QrcodeScanner = new Html5QrcodeScanner(
      "reader", { fps: 10, qrbox: 250 }
    );
    html5QrcodeScanner.render(onScanSuccess);
  </script>
</body>
</html>
